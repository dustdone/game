# 🚀 外网访问快速启动说明

## ⚡ 快速启动步骤

### 1. 创建环境配置文件
```bash
cd server
cp env.example .env
```

### 2. 编辑 .env 文件
确保以下配置正确：
```bash
HOST=0.0.0.0
PORT=5555
PROTOCOL=http
CORS_ORIGIN=*
```

### 3. 启动服务器
```bash
npm run dev
```

## 🌐 访问地址

启动成功后，你会看到类似这样的输出：
```
🚀 挂机游戏服务器启动成功!
📍 本地访问: http://localhost:5555
🌐 局域网访问: http://192.168.1.100:5555
🌍 外网访问: http://203.xxx.xxx.xxx:5555
```

## 🔧 解决CSP问题

如果遇到 `form-action 'self'` 错误：

1. **检查协议**: 确保使用HTTP而不是HTTPS
2. **清除浏览器缓存**: 强制刷新页面
3. **检查URL**: 确保地址栏显示 `http://` 而不是 `https://`

## 📱 测试访问

### 本地测试
```bash
curl http://localhost:5555/health
```

### 局域网测试
```bash
curl http://你的局域网IP:5555/health
```

### 外网测试
```bash
curl http://你的公网IP:5555/health
```

## ❗ 常见问题

### 1. 端口被占用
```bash
# 查看端口占用
lsof -i :5555

# 杀死进程
kill -9 进程ID
```

### 2. 防火墙阻止
- macOS: 系统偏好设置 → 安全性与隐私 → 防火墙
- 允许Node.js应用通过防火墙

### 3. 路由器端口转发
- 外部端口: 5555
- 内部端口: 5555
- 内部IP: 你的电脑局域网IP
- 协议: TCP

## 🎯 下一步

1. 测试本地访问
2. 测试局域网访问
3. 配置路由器端口转发
4. 测试外网访问
5. 享受你的挂机游戏！

## 📞 需要帮助？

如果遇到问题，请检查：
1. 服务器日志
2. 网络配置
3. 防火墙设置
4. 路由器配置 